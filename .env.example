# =============================================================================
# 智能GitHub代码开发协作平台 - 环境配置文件
# =============================================================================
# 使用说明：
# 1. 复制此文件为 .env：cp .env.example .env
# 2. 根据下方注释修改标记为 [必须修改] 的配置项
# 3. 标记为 [可选修改] 的配置项可根据需要调整
# 4. 标记为 [无需修改] 的配置项使用默认值即可
# =============================================================================

# -----------------------------------------------------------------------------
# 应用基础设置 [无需修改]
# 这些是应用的基本配置，通常不需要更改
# -----------------------------------------------------------------------------
APP_NAME=GitHub Code Collaboration Platform
APP_VERSION=0.1.0
DEBUG=true
API_PREFIX=/api/v1

# -----------------------------------------------------------------------------
# 服务器设置 [无需修改]
# Docker部署时使用默认值，本地开发可按需调整
# -----------------------------------------------------------------------------
HOST=0.0.0.0
PORT=8082
WORKERS=4

# -----------------------------------------------------------------------------
# 数据库设置 [无需修改 - Docker部署] / [需要修改 - 本地开发]
# Docker Compose部署时使用默认配置
# 本地开发时需要修改为本地数据库连接信息
# -----------------------------------------------------------------------------
# Docker部署使用此配置（无需修改）
DATABASE_URL=postgresql+asyncpg://postgres:postgres@db:5432/code_agent

# 本地开发时，请修改为：
# DATABASE_URL=postgresql+asyncpg://用户名:密码@localhost:5432/code_agent

DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=10

# -----------------------------------------------------------------------------
# Redis设置 [无需修改 - Docker部署] / [需要修改 - 本地开发]
# Docker Compose部署时使用默认配置
# 本地开发时需要修改为本地Redis连接信息
# -----------------------------------------------------------------------------
# Docker部署使用此配置（无需修改）
REDIS_URL=redis://redis:6379/0

# 本地开发时，请修改为：
# REDIS_URL=redis://localhost:6379/0

REDIS_TTL=3600

# -----------------------------------------------------------------------------
# GitHub OAuth设置 [必须修改]
# ⚠️ 重要：您必须创建自己的GitHub OAuth App并填入凭证
#
# 创建步骤：
# 1. 访问 https://github.com/settings/developers
# 2. 点击 "New OAuth App"
# 3. 填写应用信息（根据部署环境选择）：
#
#    【本地开发】应用运行在本地电脑上：
#    - Homepage URL: http://localhost:8082
#    - Authorization callback URL: http://localhost:8082/api/v1/github/callback
#
#    【云端/远程服务器】应用运行在远程服务器或容器中：
#    - Homepage URL: http://<服务器IP>:8082
#    - Authorization callback URL: http://<服务器IP>:8082/api/v1/github/callback
#    ⚠️ 必须使用服务器的实际IP地址，不能使用localhost！
#
# 4. 创建后获取 Client ID 和 Client Secret
#
# 详细配置说明请参考：GITHUB_OAUTH_SETUP.md
# -----------------------------------------------------------------------------
# [必须修改] 替换为您的GitHub OAuth App Client ID
GITHUB_CLIENT_ID=your_github_client_id

# [必须修改] 替换为您的GitHub OAuth App Client Secret
GITHUB_CLIENT_secret=your_github_client_secret

# [必须修改] 回调URL，必须与GitHub OAuth App中配置的完全一致
# 本地开发: http://localhost:8082/api/v1/github/callback
# 云端部署: http://<服务器IP>:8082/api/v1/github/callback
GITHUB_REDIRECT_URI=http://localhost:8082/api/v1/github/callback

# [无需修改] GitHub授权范围
GITHUB_SCOPES=repo,user

# -----------------------------------------------------------------------------
# JWT安全设置 [必须修改 - 生产环境]
# 用于用户认证的JWT令牌签名
# -----------------------------------------------------------------------------
# [必须修改 - 生产环境] 请生成一个随机的强密钥，至少32个字符
# 可使用命令生成：openssl rand -hex 32
# 开发环境可暂时使用默认值
JWT_secret_KEY=your-super-secret-key-change-in-production

# [无需修改] JWT算法和过期时间
JWT_ALGORITHM=HS256
JWT_EXPIRE_MINUTES=1440

# -----------------------------------------------------------------------------
# OpenAI设置 [必须修改 - 如需使用AI功能]
# 用于代码生成、修改、审核等AI功能
# 如果不使用AI功能，可以留空
# -----------------------------------------------------------------------------
# [必须修改] 替换为您的OpenAI API密钥
# 获取密钥：https://platform.openai.com/api-keys
OPENAI_API_KEY=your_openai_api_key

# [可选修改] 使用的模型，默认gpt-4o，可改为gpt-3.5-turbo等
OPENAI_MODEL=gpt-4o

# [无需修改] 模型参数
OPENAI_MAX_TOKENS=4096
OPENAI_TEMPERATURE=0.7

# -----------------------------------------------------------------------------
# 本地LLM设置 [可选配置]
# 如果您想使用本地部署的LLM（如CodeLlama），请取消注释并配置
# 这是OpenAI的替代方案，两者可以同时配置，通过API参数切换
# -----------------------------------------------------------------------------
# [可选] 本地LLM服务地址（兼容OpenAI API格式）
# LOCAL_LLM_URL=http://localhost:8000/v1

# [可选] 本地LLM模型名称
# LOCAL_LLM_MODEL=codellama

# -----------------------------------------------------------------------------
# 文件存储设置 [无需修改]
# 用于临时存储克隆的仓库代码
# -----------------------------------------------------------------------------
STORAGE_PATH=/tmp/code_agent
MAX_REPO_SIZE_MB=500

# -----------------------------------------------------------------------------
# CORS跨域设置 [可选修改]
# 允许访问API的前端域名列表
# 本地开发使用默认值，生产环境需要添加实际的前端域名
# -----------------------------------------------------------------------------
# [可选修改] 添加您的前端应用域名
CORS_ORIGINS=["http://localhost:3002","http://localhost:8082"]

# -----------------------------------------------------------------------------
# 速率限制设置 [无需修改]
# 防止API滥用的请求频率限制
# -----------------------------------------------------------------------------
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_PERIOD=60

# =============================================================================
# 配置检查清单
# =============================================================================
# 部署前请确认以下必填项已正确配置：
#
# ✅ GITHUB_CLIENT_ID      - GitHub OAuth Client ID
# ✅ GITHUB_CLIENT_secret  - GitHub OAuth Client Secret
# ✅ JWT_secret_KEY        - JWT签名密钥（生产环境必须修改）
# ✅ OPENAI_API_KEY        - OpenAI API密钥（如需AI功能）
#
# 可选配置（根据部署方式）：
# ⚪ DATABASE_URL          - 本地开发时修改
# ⚪ REDIS_URL             - 本地开发时修改
# ⚪ GITHUB_REDIRECT_URI   - 生产环境修改为实际域名
# ⚪ CORS_ORIGINS          - 生产环境添加前端域名
# =============================================================================
