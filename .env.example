# =============================================================================
# 智能GitHub代码开发协作平台 - 环境配置文件
# =============================================================================
# 使用说明：
# 1. 复制此文件为 .env：cp .env.example .env
# 2. 优先配置【必须配置】部分
# 3. 根据需要配置【可选配置】部分
# 4. 【无需修改】部分使用默认值即可
# =============================================================================

# =============================================================================
# ⚠️  必须配置项（部署前必须完成）
# =============================================================================

# -----------------------------------------------------------------------------
# 1. GitHub OAuth 配置 [必须配置]
# -----------------------------------------------------------------------------
# 创建 GitHub OAuth App 的步骤：
# 1. 访问 https://github.com/settings/developers
# 2. 点击 "New OAuth App"
# 3. 填写应用信息：
#
#    【本地开发】应用运行在本地电脑上：
#    - Homepage URL: http://localhost:8082
#    - Authorization callback URL: http://localhost:8082/api/v1/github/callback
#
#    【云端/远程服务器】应用运行在远程服务器或容器中：
#    - Homepage URL: http://<服务器IP>:8082
#    - Authorization callback URL: http://<服务器IP>:8082/api/v1/github/callback
#    ⚠️ 必须使用服务器的实际IP地址，不能使用localhost！
#
# 4. 创建后获取 Client ID 和 Client Secret
# 5. 详细配置说明请参考：GITHUB_OAUTH_SETUP.md
# -----------------------------------------------------------------------------

# [必须配置] GitHub OAuth App 客户端 ID
GITHUB_CLIENT_ID=your_github_client_id

# [必须配置] GitHub OAuth App 客户端密钥
GITHUB_CLIENT_secret=your_github_client_secret

# [必须配置] OAuth 回调 URL，必须与 GitHub OAuth App 中配置的完全一致
# 本地开发: http://localhost:8082/api/v1/github/callback
# 云端部署: http://<服务器IP>:8082/api/v1/github/callback
GITHUB_REDIRECT_URI=http://localhost:8082/api/v1/github/callback

# [必须配置] 前端地址，用于 OAuth 回调后的重定向
# 本地开发: http://localhost:3002
# 云端部署: http://<服务器IP>:3002 或前端实际访问地址
FRONTEND_URL=http://localhost:3002

# [无需修改] GitHub 授权范围
GITHUB_SCOPES=repo,user

# -----------------------------------------------------------------------------
# 2. LLM 提供商配置 [必须配置 - 至少选择一个]
# -----------------------------------------------------------------------------
# 选择以下任一提供商并配置，系统将使用该提供商的 AI 能力
#
# 支持的提供商：
#   - openai: OpenAI (GPT-4, GPT-3.5)
#   - siliconflow: 硅基流动 (推荐，性价比高)
#   - qwen: 阿里云千问
#   - zhipu: 智谱 AI
#   - local: 本地部署的 LLM (如 Ollama)
# -----------------------------------------------------------------------------

# [必须配置] 默认 LLM 提供商（从以下选择一个）
DEFAULT_LLM_PROVIDER=siliconflow

# ====== SiliconFlow 配置（硅基流动）- 推荐 ======
# 获取密钥：https://cloud.siliconflow.cn/account/ak
# [如果选择 siliconflow，必须配置以下项]
SILICONFLOW_API_KEY=your_siliconflow_api_key
SILICONFLOW_BASE_URL=https://api.siliconflow.cn/v1
SILICONFLOW_MODEL=Pro/zai-org/GLM-4.7

# ====== OpenAI 配置 ======
# 获取密钥：https://platform.openai.com/api-keys
# [如果选择 openai，必须配置以下项]
# OPENAI_API_KEY=your_openai_api_key
# OPENAI_MODEL=gpt-4o

# ====== Qwen 配置（千问）=====
# 获取密钥：https://dashscope.console.aliyun.com/apiKey
# [如果选择 qwen，必须配置以下项]
# QWEN_API_KEY=your_qwen_api_key
# QWEN_BASE_URL=https://dashscope.aliyuncs.com/compatible-mode/v1
# QWEN_MODEL=qwen-plus

# ====== Zhipu 配置（智谱）=====
# 获取密钥：https://open.bigmodel.cn/usercenter/apikeys
# [如果选择 zhipu，必须配置以下项]
# ZHIPU_API_KEY=your_zhipu_api_key
# ZHIPU_BASE_URL=https://open.bigmodel.cn/api/paas/v4
# ZHIPU_MODEL=glm-4

# ====== 本地 LLM 配置 ======
# [如果选择 local，必须配置以下项]
# LOCAL_LLM_URL=http://localhost:11434/v1
# LOCAL_LLM_MODEL=llama2

# -----------------------------------------------------------------------------
# 3. JWT 安全配置 [必须配置 - 生产环境]
# -----------------------------------------------------------------------------
# [必须配置 - 生产环境] 请生成一个随机的强密钥，至少 32 个字符
# 生成命令：openssl rand -hex 32
# 开发环境可暂时使用默认值
JWT_secret_KEY=your-super-secret-key-change-in-production

# [无需修改] JWT 算法和过期时间
JWT_ALGORITHM=HS256
JWT_EXPIRE_MINUTES=1440


# =============================================================================
# ⚙️  可选配置项（根据需要调整）
# =============================================================================

# -----------------------------------------------------------------------------
# 应用基础设置 [可选]
# -----------------------------------------------------------------------------
APP_NAME=GitHub Code Collaboration Platform
APP_VERSION=0.1.0
DEBUG=true
API_PREFIX=/api/v1

# -----------------------------------------------------------------------------
# 服务器设置 [可选]
# -----------------------------------------------------------------------------
HOST=0.0.0.0
PORT=8082
WORKERS=4

# -----------------------------------------------------------------------------
# 数据库设置 [Docker 部署无需修改 / 本地开发需要修改]
# -----------------------------------------------------------------------------
# Docker 部署使用此配置（无需修改）
DATABASE_URL=postgresql+asyncpg://postgres:postgres@db:5432/code_agent

# 本地开发时，请修改为：
# DATABASE_URL=postgresql+asyncpg://用户名:密码@localhost:5432/code_agent

DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=10

# -----------------------------------------------------------------------------
# Redis 设置 [Docker 部署无需修改 / 本地开发需要修改]
# -----------------------------------------------------------------------------
# Docker 部署使用此配置（无需修改）
REDIS_URL=redis://redis:6380/0

# 本地开发时，请修改为：
# REDIS_URL=redis://localhost:6380/0

REDIS_TTL=3600

# -----------------------------------------------------------------------------
# LLM 参数调优 [可选]
# -----------------------------------------------------------------------------
OPENAI_MAX_TOKENS=4096
OPENAI_TEMPERATURE=0.7

# -----------------------------------------------------------------------------
# 文件存储设置 [可选]
# -----------------------------------------------------------------------------
STORAGE_PATH=/tmp/code_agent
MAX_REPO_SIZE_MB=500

# -----------------------------------------------------------------------------
# CORS 跨域设置 [可选]
# -----------------------------------------------------------------------------
# 允许访问 API 的前端域名列表
# 本地开发使用默认值，生产环境需要添加实际的前端域名
CORS_ORIGINS=["http://localhost:3002","http://localhost:8082"]

# -----------------------------------------------------------------------------
# 速率限制设置 [可选]
# -----------------------------------------------------------------------------
# 防止 API 滥用的请求频率限制
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_PERIOD=60


# =============================================================================
# ✅ 配置检查清单
# =============================================================================
# 部署前请确认以下必填项已正确配置：
#
# 【必须配置】
# ✅ GITHUB_CLIENT_ID           - GitHub OAuth Client ID
# ✅ GITHUB_CLIENT_secret   - GitHub OAuth Client Secret
# ✅ GITHUB_REDIRECT_URI        - OAuth 回调 URL
# ✅ FRONTEND_URL              - 前端地址
# ✅ DEFAULT_LLM_PROVIDER       - 默认 LLM 提供商
# ✅ 对应的 LLM API Key       - SiliconFlow/OpenAI/Qwen/Zhipu/Local
# ✅ JWT_secret_KEY         - JWT 签名密钥（生产环境必须修改）
#
# 【可选配置】
# ⚪ DATABASE_URL               - 本地开发时修改
# ⚪ REDIS_URL                  - 本地开发时修改
# ⚪ CORS_ORIGINS              - 生产环境添加前端域名
# ⚪ OPENAI_MAX_TOKENS         - 根据需要调整
# ⚪ OPENAI_TEMPERATURE        - 根据需要调整
# =============================================================================
